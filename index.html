<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Popup btn demo with header and close button</title>
  </head>
  <body>
    <div style="width: 100dvw; height: 100dvh; background-color: aquamarine">
      <header style="padding: 12px">Here is header</header>
      <hr />
      <main style="padding: 12px">here is main</main>
    </div>
    <!-- Popup button and container wrapper -->
    <div id="popupWrapper">
      <!-- 固定在右下角的按鈕 -->
      <button
        id="popupBtn"
        style="
          position: fixed;
          bottom: 20px;
          right: 20px;
          background-color: #007bff;
          color: white;
          border: none;
          padding: 10px 20px;
          border-radius: 5px;
          cursor: pointer;
        "
      >
        Toggle Modal
      </button>

      <!-- 這裡會新增 popup 視窗 -->
      <div id="popupContainer" style="position: relative;"></div>
    </div>

    <script>
      document
        .getElementById("popupBtn")
        .addEventListener("click", function () {
          const popupContainer = document.getElementById("popupContainer");
          const popupDiv = document.querySelector(".popupDiv");

          if (popupDiv) {
            // 如果已存在彈窗，淡出後移除
            popupDiv.style.opacity = "0";
            setTimeout(() => {
              popupDiv.remove();
            }, 500); // 與 transition 時間相同
          } else {
            // 創建新彈窗並淡入
            const newPopupDiv = document.createElement("div");
            newPopupDiv.classList.add("popupDiv");
            newPopupDiv.innerHTML = `
              <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid black; padding-bottom: 10px;">
                <h3>Popup Header</h3>
                <button id="closeBtn" style="background-color: red; color: white; border: none; padding: 5px 10px; cursor: pointer;">Close</button>
              </div>
              <div style="padding: 10px;">This is the popup content area with animation!</div>
            `;
            newPopupDiv.setAttribute(
              "style",
              "position: absolute; right: 20px; bottom: 70px; width: 300px; height: 200px; background-color: white; border: 2px solid black; padding: 10px; opacity: 0; transition: opacity 0.5s ease;"
            );
            popupContainer.appendChild(newPopupDiv);

            // 等待下一個事件循環後再觸發動畫
            setTimeout(() => {
              newPopupDiv.style.opacity = "1";
            }, 10);

            // 關閉彈窗按鈕功能
            document.getElementById("closeBtn").addEventListener("click", function () {
              newPopupDiv.style.opacity = "0";
              setTimeout(() => {
                newPopupDiv.remove();
              }, 500);
            });
          }
        });
    </script>
  </body>
</html>

<style>
  body {
    margin: 0;
    height: 0;
  }
</style>
